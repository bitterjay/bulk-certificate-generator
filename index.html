<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Certificate Generator</title>
    <!-- Google Fonts - Poppins -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <!-- Swiper CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>USA Archery Certificate Generator</h1>
            <p>Generate personalized certificates for USA Archery events.</p>
        </header>
        
        <div class="main-layout">
            <aside class="sidebar">
                <section id="data-input">
                    <h2>1. Paste Excel Data</h2>
                    <button id="paste-from-clipboard" class="paste-button">Paste from Clipboard</button>
                    <textarea id="paste-data" class="hidden-textarea" placeholder="Paste your Excel data here (tab-separated)" style="display: none;"></textarea>
                    <button id="manual-paste-toggle" class="manual-paste-toggle">Manual Paste</button>
                    <button id="use-sample-data" class="sample-data-button">Use Sample Data</button>
                    <button id="show-table" style="display: none;">Show Table</button>
                </section>

                <section id="table-display">
                    <div id="table-container"></div>
                </section>

                <section id="image-upload">
                    <h2>4. Upload Certificate Background</h2>
                    <div class="file-upload-container">
                        <input type="file" id="png-upload" accept=".png,.jpg,.jpeg" style="display: none;">
                        <button type="button" id="upload-trigger" class="upload-button">
                            üìÅ Choose Certificate Background
                        </button>
                        <div id="filename-display" class="filename-display" style="display: none;">
                            <span class="filename-text">No file selected</span>
                            <button type="button" id="clear-file" class="clear-file-button" title="Clear selection">√ó</button>
                        </div>
                    </div>
                    <button id="view-image-button" class="view-image-button" style="display: none;">
                        View Uploaded Image
                    </button>
                </section>

                <section id="date-selection">
                    <h2>5. Select Certificate Date</h2>
                    <div class="date-input-group">
                        <input type="date" id="certificate-date">
                        <button type="button" id="today-button" class="today-button">Today</button>
                    </div>
                </section>

                <section id="layout-selection" style="display: none;">
                    <h2>2. Choose Layout Preset (Optional)</h2>
                    <div class="layout-controls">
                                <select id="layout-selector" class="layout-dropdown">
                                    <!-- Options populated dynamically, default will be pre-selected -->
                                </select>
                        <div id="layout-description" class="layout-description" style="display: none;"></div>
                        <div id="layout-columns" class="layout-expected-columns" style="display: none;"></div>
                    </div>
                </section>

                <section id="preview-controls">
                    <h2>6. Generate Preview</h2>
                    <button id="generate-preview" disabled>Generate Preview</button>
                    <button id="generate-test-portrait-preview" class="test-button">Test Portrait Preview</button>
                    <button id="generate-test-landscape-preview" class="test-button">Test Landscape Preview</button>
                </section>

                <section id="export-controls">
                    <h2>7. Generate Certificates</h2>
                    <button id="generate-pdf" disabled>Generate PDF</button>
                </section>
            </aside>

            <main class="main-content">

                <section id="column-selection">
                    <!-- Column selection UI will be dynamically generated here -->
                </section>

                <section id="preview-area">
                    <h2>Certificate Preview</h2>
                    <div id="preview-controls-container">
                        <!-- Preview slider and element selection -->
                        <div class="preview-column">
                            <div class="swiper" id="preview-slider">
                                <div class="swiper-wrapper" id="preview-container">
                                    <!-- Slides will be dynamically generated here -->
                                </div>
                                <!-- Navigation -->
                                <div class="swiper-pagination"></div>
                                <div class="swiper-button-next"></div>
                                <div class="swiper-button-prev"></div>
                            </div>
                            <div class="element-selection">
                                <div id="element-buttons-container">
                                    <!-- Element selection buttons will be generated dynamically -->
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Sliding Element Control Panel -->
                <div id="element-control-panel" class="element-control-panel">
                    <div class="panel-header">
                        <h3>Element Editor</h3>
                        <button id="close-panel-button" class="close-panel-button" aria-label="Close Panel">&times;</button>
                    </div>
                    <div id="control-widgets">
                        <!-- Control widgets will appear here when element is selected -->
                    </div>
                </div>

                <!-- Panel Backdrop -->
                <div id="panel-backdrop" class="panel-backdrop"></div>
            </main>
        </div>
    </div>

    <!-- Image Lightbox -->
    <div id="image-lightbox" class="lightbox-overlay" style="display: none;">
        <div class="lightbox-container">
            <button class="lightbox-close" aria-label="Close">&times;</button>
            <img id="lightbox-image" class="lightbox-image" alt="Certificate background">
        </div>
    </div>

    <!-- Table Lightbox -->
    <div id="table-lightbox" class="lightbox-overlay" style="display: none;">
        <div class="lightbox-container table-lightbox-container">
            <button class="lightbox-close" aria-label="Close">&times;</button>
            <div class="lightbox-table-content">
                <h3>Imported Data Table</h3>
                <div id="lightbox-table-container"></div>
            </div>
        </div>
    </div>

    <!-- Swiper JS -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    
    <!-- Load main application -->
    <script type="module" src="src/app.js"></script>
</body>
</html>
